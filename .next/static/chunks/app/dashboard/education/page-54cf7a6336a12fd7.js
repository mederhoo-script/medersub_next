(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5840],{723:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(8340).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},1142:(e,t,s)=>{"use strict";s.d(t,{N:()=>r});let r=(0,s(6622).createBrowserClient)("https://arbagxcbwqmquydrowjw.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFyYmFneGNid3FtcXV5ZHJvd2p3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY1NjIwMjMsImV4cCI6MjA3MjEzODAyM30.k7-oHFYulHIWs56vBzhQnClvJAlLfhyhdL7rZuauAfk")},2651:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(8340).A)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},3321:(e,t,s)=>{"use strict";var r=s(4645);s.o(r,"usePathname")&&s.d(t,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(t,{useSearchParams:function(){return r.useSearchParams}})},5559:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(8340).A)("graduation-cap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]])},6296:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(8340).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},6577:(e,t,s)=>{Promise.resolve().then(s.bind(s,9209))},9209:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>x});var r=s(5155),a=s(2115),l=s(1142),n=s(723),i=s(6296),c=s(5559),d=s(2651),o=s(3321),m=s(8500),u=s.n(m);function x(){let e=(0,o.useRouter)(),[t,s]=(0,a.useState)([]),[m,x]=(0,a.useState)(!0),[h,p]=(0,a.useState)(null),[g,b]=(0,a.useState)(1),[y,f]=(0,a.useState)(!1),[N,j]=(0,a.useState)(null),[v,w]=(0,a.useState)([]);(0,a.useEffect)(()=>{I()},[]);let I=async()=>{x(!0);try{let e=await fetch("/api/services"),t=await e.json();console.log(t),"success"===t.status&&t.data&&t.data.education&&s(t.data.education)}catch(e){console.error("Failed to fetch services",e)}finally{x(!1)}},A=async t=>{if(t.preventDefault(),h){f(!0),j(null),w([]);try{let{data:{user:t}}=await l.N.auth.getUser();if(!t)return void e.push("/login");let s=Number(h.amount.replace(/,/g,""))*g,r=await fetch("/api/purchase",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:t.id,serviceType:"EDUCATION",amount:s,mobileNumber:"",serviceID:h.serviceID,quantity:g})}),a=await r.json();a.error?j({type:"error",msg:a.error}):(j({type:"success",msg:`Successfully purchased ${g} ${h.type} pin(s)!`}),a.pins&&Array.isArray(a.pins)&&w(a.pins),p(null),b(1),e.refresh())}catch(e){j({type:"error",msg:"Something went wrong."})}finally{f(!1)}}};return(0,r.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,r.jsx)(u(),{href:"/dashboard",className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:(0,r.jsx)(n.A,{className:"h-5 w-5 text-gray-600"})}),(0,r.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"Buy Exam Pins"}),(0,r.jsx)("h1",{className:"text-2xl items-right font-bold text-blue-600 tracking-tight",children:"MEDERSUB"})]}),(0,r.jsx)("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100",children:(0,r.jsxs)("form",{onSubmit:A,className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Select Exam Type"}),m?(0,r.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,r.jsx)(i.A,{className:"h-6 w-6 animate-spin text-gray-400"})}):(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:t.map(e=>{let t=Number(e.amount.replace(/,/g,""));return(0,r.jsxs)("button",{type:"button",onClick:()=>p(e),className:`flex flex-col items-center p-4 rounded-xl border-2 transition-all ${h?.serviceID===e.serviceID?"border-green-600 bg-green-50":"border-gray-200 bg-white hover:bg-gray-50"}`,children:[(0,r.jsx)(c.A,{className:`h-10 w-10 mb-2 ${h?.serviceID===e.serviceID?"text-green-600":"text-gray-400"}`}),(0,r.jsx)("span",{className:"font-bold text-lg",children:e.type}),(0,r.jsxs)("span",{className:"text-sm text-gray-600",children:["₦",(t+20).toLocaleString(),"/pin"]})]},e.serviceID)})}),0===t.length&&!m&&(0,r.jsx)("p",{className:"text-xs text-red-500 mt-1",children:"No education services available."})]}),h&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quantity (1-10 pins)"}),(0,r.jsx)("input",{type:"number",min:"1",max:"10",required:!0,value:g,onChange:e=>b(Number(e.target.value)),className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-green-500",placeholder:"Enter quantity"})]}),h&&(0,r.jsxs)("div",{className:"bg-blue-50 p-4 rounded-xl",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Total Amount:"}),(0,r.jsxs)("span",{className:"text-2xl font-bold text-blue-600",children:["₦",(!h?0:(Number(h.amount.replace(/,/g,""))+20)*g).toLocaleString()]})]}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[g," \xd7 ",h.type," pin(s)"]})]}),N&&(0,r.jsx)("div",{className:`p-4 rounded-xl text-sm ${"success"===N.type?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:N.msg}),v.length>0&&(0,r.jsxs)("div",{className:"bg-green-50 p-4 rounded-xl border border-green-200",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,r.jsx)(d.A,{className:"h-5 w-5 text-green-600"}),(0,r.jsx)("h3",{className:"font-bold text-green-900",children:"Your Exam Pins"})]}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full text-sm",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"border-b border-green-200",children:[(0,r.jsx)("th",{className:"text-left py-2 px-3 font-semibold text-green-900",children:"#"}),(0,r.jsx)("th",{className:"text-left py-2 px-3 font-semibold text-green-900",children:"PIN"}),(0,r.jsx)("th",{className:"text-left py-2 px-3 font-semibold text-green-900",children:"Serial Number"})]})}),(0,r.jsx)("tbody",{children:v.map((e,t)=>(0,r.jsxs)("tr",{className:"border-b border-green-100",children:[(0,r.jsx)("td",{className:"py-2 px-3 text-green-800",children:t+1}),(0,r.jsx)("td",{className:"py-2 px-3 font-mono text-green-900 font-semibold",children:e.pin.trim()}),(0,r.jsx)("td",{className:"py-2 px-3 font-mono text-green-900",children:e.serialNo.trim()})]},t))})]})}),(0,r.jsx)("p",{className:"text-xs text-green-700 mt-3",children:"\uD83D\uDCA1 Please save these details. You can also find them in your transaction history."})]}),(0,r.jsx)("button",{type:"submit",disabled:y||!h,className:"w-full py-4 bg-green-600 text-white rounded-xl font-bold text-lg hover:bg-green-700 transition-colors disabled:opacity-70 flex items-center justify-center gap-2",children:y?(0,r.jsx)(i.A,{className:"h-5 w-5 animate-spin"}):"Buy Now"})]})})]})}}},e=>{e.O(0,[8500,4293,8441,8928,7358],()=>e(e.s=6577)),_N_E=e.O()}]);