(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8733],{386:(e,t,a)=>{Promise.resolve().then(a.bind(a,8612))},1878:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(8340).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},3210:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(8340).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},6296:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(8340).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},8340:(e,t,a)=>{"use strict";a.d(t,{A:()=>d});var s=a(2115);let r=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},l=(...e)=>e.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim();var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=(0,s.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:a=2,absoluteStrokeWidth:r,className:n="",children:d,iconNode:c,...o},x)=>(0,s.createElement)("svg",{ref:x,...i,width:t,height:t,stroke:e,strokeWidth:r?24*Number(a)/Number(t):a,className:l("lucide",n),...!d&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(o)&&{"aria-hidden":"true"},...o},[...c.map(([e,t])=>(0,s.createElement)(e,t)),...Array.isArray(d)?d:[d]])),d=(e,t)=>{let a=(0,s.forwardRef)(({className:a,...i},d)=>(0,s.createElement)(n,{ref:d,iconNode:t,className:l(`lucide-${r(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,a),...i}));return a.displayName=r(e),a}},8368:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(8340).A)("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},8612:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>u});var s=a(5155),r=a(2115),l=a(1878),i=a(6296),n=a(9823),d=a(8368),c=a(3210),o=a(8500),x=a.n(o);function u(){let[e,t]=(0,r.useState)([]),[a,o]=(0,r.useState)(!0),[u,h]=(0,r.useState)(""),[m,p]=(0,r.useState)(null),[y,b]=(0,r.useState)(!1);(0,r.useEffect)(()=>{g()},[]);let g=async()=>{try{let e=await fetch("/api/admin/users"),a=await e.json();Array.isArray(a)&&t(a)}catch(e){console.error("Failed to fetch users",e)}finally{o(!1)}},f=async e=>{e.preventDefault(),b(!0);try{(await fetch("/api/admin/users",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:m.id,full_name:m.full_name,role:m.role,balance:m.balance})})).ok?(alert("User updated successfully"),p(null),g()):alert("Failed to update user")}catch(e){alert("Error updating user")}finally{b(!1)}},j=e.filter(e=>e.email?.toLowerCase().includes(u.toLowerCase())||e.full_name?.toLowerCase().includes(u.toLowerCase()));return(0,s.jsxs)("div",{className:"space-y-6 relative",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"User Management"}),(0,s.jsx)("div",{className:"flex gap-3",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(l.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,s.jsx)("input",{type:"text",placeholder:"Search users...",value:u,onChange:e=>h(e.target.value),className:"pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})})]}),(0,s.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Balance"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Joined"}),(0,s.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:a?(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:5,className:"px-6 py-8 text-center",children:(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)(i.A,{className:"h-8 w-8 animate-spin text-blue-500"})})})}):0===j.length?(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:5,className:"px-6 py-8 text-center text-gray-500",children:"No users found."})}):j.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"h-10 w-10 flex-shrink-0",children:(0,s.jsx)("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 font-bold",children:e.full_name?.charAt(0)||e.email?.charAt(0)})}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.full_name||"N/A"}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:e.email})]})]})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${"ADMIN"===e.role?"bg-purple-100 text-purple-800":"bg-green-100 text-green-800"}`,children:e.role})}),(0,s.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:["₦",e.balance?.toLocaleString()]}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.created_at).toLocaleDateString()}),(0,s.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium flex justify-end gap-2",children:[(0,s.jsx)("button",{onClick:()=>p(e),className:"text-blue-600 hover:text-blue-900 p-1 bg-blue-50 rounded",title:"Edit User",children:(0,s.jsx)(n.A,{className:"h-4 w-4"})}),(0,s.jsx)(x(),{href:`/admin/transactions?search=${e.email}`,className:"text-gray-600 hover:text-gray-900 p-1 bg-gray-100 rounded",title:"View Transactions",children:(0,s.jsx)(d.A,{className:"h-4 w-4"})}),(0,s.jsx)("button",{onClick:async()=>{let t=e.is_blocked?"UNBLOCK":"BLOCK";if(confirm(`Are you sure you want to ${t} this user?`))try{await fetch("/api/admin/users/block",{method:"POST",body:JSON.stringify({userId:e.id,action:t})}),g()}catch(e){console.error(e)}},className:`text-xs px-2 py-1 rounded border ${e.is_blocked?"text-green-600 border-green-200 bg-green-50":"text-red-600 border-red-200 bg-red-50"}`,children:e.is_blocked?"Unblock":"Block"})]})]},e.id))})]})}),m&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-xl p-6 w-full max-w-md shadow-2xl",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsx)("h3",{className:"text-lg font-bold",children:"Edit User"}),(0,s.jsx)("button",{onClick:()=>p(null),children:(0,s.jsx)(c.A,{className:"h-5 w-5 text-gray-500"})})]}),(0,s.jsxs)("form",{onSubmit:f,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Full Name"}),(0,s.jsx)("input",{type:"text",value:m.full_name||"",onChange:e=>p({...m,full_name:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 border p-2"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Role"}),(0,s.jsxs)("select",{value:m.role,onChange:e=>p({...m,role:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 border p-2",children:[(0,s.jsx)("option",{value:"USER",children:"USER"}),(0,s.jsx)("option",{value:"ADMIN",children:"ADMIN"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Wallet Balance (₦)"}),(0,s.jsx)("input",{type:"number",value:m.balance,onChange:e=>p({...m,balance:e.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 border p-2"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Directly overriding the balance."})]}),(0,s.jsxs)("div",{className:"pt-4 flex justify-end gap-2",children:[(0,s.jsx)("button",{type:"button",onClick:()=>p(null),className:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",disabled:y,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:y?"Saving...":"Save Changes"})]})]})]})})]})}},9823:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(8340).A)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])}},e=>{e.O(0,[8500,8441,8928,7358],()=>e(e.s=386)),_N_E=e.O()}]);